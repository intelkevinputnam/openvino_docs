
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Directed Acyclic Graph (DAG) Scheduler {#ovms_docs_dag} &#8212; OpenVINO™  documentation</title>
    
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/doxyrest-pygments.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <link href="../../../../_static/css/media/favicon.ico" rel="shortcut icon">
    <link rel="stylesheet" href="../../../../_static/css/openvino_sphinx_theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/button.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/input.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/textfield.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/tabs.css" type="text/css" />
    <script src="../../../../_static/js/openvino_sphinx_theme.js"></script>
    <link rel="stylesheet" href="../../../../_static/css/viewer.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-barchart-background@1.3.0/build/Plugin.Barchart.Background.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-deferred@1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
    <script src="../../../../_static/js/viewer.min.js"></script>
    <script src="/assets/versions_raw.js"></script>

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/js/custom.js"></script>
    <script src="../../../../_static/js/graphs.js"></script>
    <script src="../../../../_static/js/graphs_ov_tf.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="../../../../_static/target-highlight.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="canonical" href="https://docs.openvino.ai/latest/pages/documentation/ecosystem/model-server/dag_scheduler.html" />
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
      <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../get-started-guide.html">
  Get Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../documentation.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../api/api_reference.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../model_zoo.html">
  Model Zoo
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../resources.html">
  Resources
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../languages/zh_CN/index.html">
  简体中文
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openvinotoolkit/openvino" rel="noopener" target="_blank" title="GitHub">
            <span><i class="sst-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
</ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown sst-dropdown sst-dropdown-navbar">
  <button class="btn sst-btn dropdown-toggle" type="button" id="version-selector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
  <div class="dropdown-menu" aria-labelledby="version-selector">
  </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        

<div class="dropdown sst-dropdown sst-dropdown-navbar">
  <button class="btn sst-btn dropdown-toggle" type="button" id="language-selector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">English</button>
  <div class="dropdown-menu" aria-labelledby="language-selector">
    
      
        <a class="dropdown-item font-weight-bold" href="openvino_docs/index.html">English</a>
      
    
      
        <a  class="dropdown-item" href="openvino_docs/languages/zh_CN/index.html">简体中文 (Simplified Chinese)</a>
      
    
  </div>
</div>

      </div>
      
    </div>
  </div>
</div>
        <div id="collapse-nav-wrapper" class="container-xl">
          <button id="collapse-nav" class="button bttn-prm button-size-m" type="button" data-toggle="collapse" data-target="#nav-tree" aria-expanded="false" aria-controls="nav-tree">
            Documentation navigation <i class="fas fa-chevron-down"></i>
          </button>
        </div>
      </nav>
      <div class="transition-banner container-fluid alert alert-info alert-dismissible fade show" role="alert">
        <p>OpenVINO 2022.1 introduces a new version of OpenVINO API (API 2.0). For more information on the changes and transition steps, see the <a href="https://docs.openvino.ai/latest/openvino_2_0_transition_guide.html">transition guide</a></p>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
    </div>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar" id="nav-tree"><form class="searchForm bd-search d-flex align-items-center" action="../../../../search.html" method="get">
    <i class="icon fas fa-search"></i>
    <input type="search" class="form-control" name="query" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#node-types-a-name-node-type-a">
   Node Types
   <a name="node-type">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#auxiliary-node-types">
     Auxiliary Node Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deep-learning-node-type">
     Deep Learning node type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-node-type">
     Custom node type
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#demultiplexing-data">
   Demultiplexing data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#configuration-file-a-name-configuration-file-a">
   Configuration file
   <a name="configuration-file">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pipeline-configuration-options-explained">
     Pipeline configuration options explained
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-options">
     Node Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-input-options">
     Node Input Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#node-output-options">
     Node Output Options
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-node-options">
     Custom Node Options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-pipelines-a-name-using-pipelines-a">
   Using Pipelines
   <a name="using-pipelines">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pipelines-examples-a-name-pipeline-examples-a">
   Pipelines Examples
   <a name="pipeline-examples">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#current-limitations-a-name-current-limitations-a">
   Current limitations
   <a name="current-limitations">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#see-also">
   See Also
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                <div class="tocsection download-docs">
  <div class="dropdown sst-dropdown">
    <button class="button bttn-prm button-size-m" data-display="static" type="button" id="download-options"
      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Download Docs
    </button>
    <div class="dropdown-menu" aria-labelledby="download-options">
      <a class="dropdown-item" href="#" onclick="window.print()">.pdf</a>
      <a id="download-zip-btn" class="dropdown-item" href="#">.zip</a>
    </div>
  </div>
</div>
              </div>
              
            
          </div>
          

          
          
              
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">

<div class="tocsection editthispage">
    <a href="None">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

            
                <div>
                  
  <section id="directed-acyclic-graph-dag-scheduler-ovms-docs-dag">
<h1>Directed Acyclic Graph (DAG) Scheduler {#ovms_docs_dag}<a class="headerlink" href="#directed-acyclic-graph-dag-scheduler-ovms-docs-dag" title="Permalink to this headline">¶</a></h1>
<p>&#64;sphinxdirective</p>
<p>.. toctree::
:maxdepth: 1
:hidden:</p>
<p>ovms_docs_demuliplexing
ovms_docs_custom_node_development</p>
<p>&#64;endsphinxdirective</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Directed Acyclic Graph (DAG) Scheduler makes it possible to create a pipeline of models for execution in a single client request.
The pipeline is a Directed Acyclic Graph with different nodes which define how to process each step of predict request.
By using a pipeline, there is no need to return intermediate results of every model to the client. This allows avoiding the network overhead by minimizing the number of requests sent to the Model Server.
Each model output can be mapped to another model input. Since intermediate results are kept in the server’s RAM these can be reused by subsequent inferences which reduce overall latency.</p>
<p>This guide gives information about:</p>
<ul class="simple">
<li><p><a href="#node-type">Node Types</a></p></li>
<li><p><a href="#configuration-file">Configuration file</a></p></li>
<li><p><a href="#using-pipelines">Using the pipelines</a></p></li>
<li><p><a href="#pipeline-examples">Pipelines examples </a></p></li>
<li><p><a href="#current-limitations">Current Limitations</a></p></li>
</ul>
</section>
<section id="node-types-a-name-node-type-a">
<h2>Node Types <a name="node-type"></a><a class="headerlink" href="#node-types-a-name-node-type-a" title="Permalink to this headline">¶</a></h2>
<section id="auxiliary-node-types">
<h3>Auxiliary Node Types<a class="headerlink" href="#auxiliary-node-types" title="Permalink to this headline">¶</a></h3>
<p>There are two special kinds of nodes - Request and Response node. Both of them are predefined and included in every pipeline definition you create:</p>
<ul class="simple">
<li><p>Request node</p>
<ul>
<li><p>This node defines which inputs are required to be sent via gRPC/REST request for pipeline usage. You can refer to it by node name: <code class="docutils literal notranslate"><span class="pre">request</span></code>.</p></li>
</ul>
</li>
<li><p>Response node</p>
<ul>
<li><p>This node defines which outputs will be fetched from the final pipeline state and packed into gRPC/REST response.
You cannot refer to it in your pipeline configuration since it is the pipeline final stage. To define final outputs fill <code class="docutils literal notranslate"><span class="pre">outputs</span></code> field.</p></li>
</ul>
</li>
</ul>
</section>
<section id="deep-learning-node-type">
<h3>Deep Learning node type<a class="headerlink" href="#deep-learning-node-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>DL model - this node contains underlying OpenVINO™ model and performs inference on the selected target device. This can be defined in the configuration file.
Each model input needs to be mapped to some node’s <code class="docutils literal notranslate"><span class="pre">data_item</span></code> - input from gRPC/REST <code class="docutils literal notranslate"><span class="pre">request</span></code> or another <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> output.
Outputs of the node may be mapped to another node’s inputs or the <code class="docutils literal notranslate"><span class="pre">response</span></code> node, meaning it will be exposed in gRPC/REST response.</p></li>
</ul>
</section>
<section id="custom-node-type">
<h3>Custom node type<a class="headerlink" href="#custom-node-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>custom - that node can be used to implement all operations on the data which can not be handled by the neural network model. It is represented by
a C++ dynamic library implementing OVMS API defined in <a class="reference external" href="https://github.com/openvinotoolkit/model_server/blob/releases/2022/1/src/custom_node_interface.h">custom_node_interface.h</a>. Custom nodes can run the data
processing using OpenCV, which is included in OVMS, or include other third-party components. Custom node libraries are loaded into OVMS
by adding their definition to the pipeline configuration. The configuration includes a path to the compiled binary with the <code class="docutils literal notranslate"><span class="pre">.so</span></code> extension.
Custom nodes are not versioned, meaning one custom node library is bound to one name. To load another version, another name needs to be used.</p></li>
</ul>
<p>Learn more about developing custom node in the <a class="reference internal" href="custom_node_development.html"><span class="doc std std-doc">custom node developer guide</span></a></p>
</section>
</section>
<section id="demultiplexing-data">
<h2>Demultiplexing data<a class="headerlink" href="#demultiplexing-data" title="Permalink to this headline">¶</a></h2>
<p>During the pipeline execution, it is possible to split a request with multiple batches into a set of branches with a single batch.
That way a model configured with a batch size 1, can process requests with arbitrary batch size. Internally, OVMS demultiplexer will
divide the data, process them in parallel and combine the results.</p>
<p>De-multiplication of the node output is enabled in the configuration file by adding <code class="docutils literal notranslate"><span class="pre">demultiply_count</span></code>.
It assumes the batches are combined on the first dimension which is dropped after splitting. For example:</p>
<ul class="simple">
<li><p>a node returns output with shape <code class="docutils literal notranslate"><span class="pre">[8,1,3,224,224]</span></code></p></li>
<li><p>demuliplexer creates 8 requests with shape <code class="docutils literal notranslate"><span class="pre">[1,3,224,224]</span></code></p></li>
<li><p>next model processes in parallel 8 requests with output shape <code class="docutils literal notranslate"><span class="pre">[1,1001]</span></code> each.</p></li>
<li><p>results are combined into a single output with shape <code class="docutils literal notranslate"><span class="pre">[8,1,1001]</span></code></p></li>
</ul>
<p><a class="reference internal" href="demultiplexing.html"><span class="doc std std-doc">Learn more about demuliplexing</span></a></p>
</section>
<section id="configuration-file-a-name-configuration-file-a">
<h2>Configuration file <a name="configuration-file"></a><a class="headerlink" href="#configuration-file-a-name-configuration-file-a" title="Permalink to this headline">¶</a></h2>
<p>Pipelines configuration is to be placed in the same json file like the
<a class="reference internal" href="multiple_models_mode.html"><span class="doc std std-doc">models config file</span></a>.
While models are defined in section <code class="docutils literal notranslate"><span class="pre">model_config_list</span></code>, pipelines are to be configured in
section <code class="docutils literal notranslate"><span class="pre">pipeline_config_list</span></code>.
Nodes in the pipelines can reference only the models configured in model_config_list section.</p>
<p>Basic pipeline section template is depicted below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="p">{</span>
    <span class="s2">&quot;model_config_list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;custom_node_library_config_list&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_node_lib&quot;</span><span class="p">,</span>
            <span class="s2">&quot;base_path&quot;</span><span class="p">:</span> <span class="s2">&quot;/libs/libcustom_node.so&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;pipeline_config_list&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;pipeline name&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;input1&gt;&quot;</span><span class="p">,</span><span class="o">...</span><span class="p">],</span>
            <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;node name&gt;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">reference</span> <span class="n">to</span> <span class="n">the</span> <span class="n">model</span><span class="o">&gt;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;DL model&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;node_name&quot;</span><span class="p">:</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span>  <span class="c1"># reference to pipeline input</span>
                                   <span class="s2">&quot;data_item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;input1&gt;&quot;</span><span class="p">}}</span>  <span class="c1"># input name from the request</span>
                    <span class="p">],</span> 
                    <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># mapping the model output name to node output name</span>
                        <span class="p">{</span><span class="s2">&quot;data_item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;model output&gt;&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;node output name&gt;&quot;</span><span class="p">}</span>
                    <span class="p">]</span> 
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;custon_node_name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;library_name&quot;</span><span class="p">:</span> <span class="s2">&quot;custom_node_lib&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;custom&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;param1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;param2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;node_name&quot;</span><span class="p">:</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span>  <span class="c1"># reference to pipeline input</span>
                                   <span class="s2">&quot;data_item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;input1&gt;&quot;</span><span class="p">}}</span>  <span class="c1"># input name from the request</span>
                    <span class="p">],</span> 
                    <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span><span class="s2">&quot;data_item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;library_output&gt;&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;node_output&gt;&quot;</span><span class="p">},</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>      <span class="c1"># pipeline outputs</span>
                <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;node_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;node to return results&gt;&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;data_item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;node output name to return results&gt;&quot;</span><span class="p">}}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="pipeline-configuration-options-explained">
<h3>Pipeline configuration options explained<a class="headerlink" href="#pipeline-configuration-options-explained" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Pipeline identifier related to name field specified in gRPC/REST request</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;inputs&quot;</span></code></p></td>
<td class="text-left"><p>array</p></td>
<td class="text-left"><p>Defines input names required to be present in gRPC/REST request</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;outputs&quot;</span></code></p></td>
<td class="text-left"><p>array</p></td>
<td class="text-left"><p>Defines outputs (data items) to be retrieved from intermediate results (nodes) after pipeline execution completed for final gRPC/REST response to the client</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;nodes&quot;</span></code></p></td>
<td class="text-left"><p>array</p></td>
<td class="text-left"><p>Declares nodes used in pipeline and its connections</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="node-options">
<h3>Node Options<a class="headerlink" href="#node-options" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Node name so you can refer to it from other nodes</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;model_name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>You can specify underlying model (needs to be defined in <code class="docutils literal notranslate"><span class="pre">model_config_list</span></code>), available only for <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> nodes</p></td>
<td class="text-left"><p>required for <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> nodes</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;version&quot;</span></code></p></td>
<td class="text-left"><p>integer</p></td>
<td class="text-left"><p>You can specify a model version for inference, available only for <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> nodes</p></td>
<td class="text-left"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;type&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Node kind, currently there are 2 types available: <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">custom</span></code></p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;demultiply_count&quot;</span></code></p></td>
<td class="text-left"><p>integer</p></td>
<td class="text-left"><p>Splits node outputs to desired chunks and branches pipeline execution</p></td>
<td class="text-left"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;gather_from_node&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Setups node to converge pipeline and collect results into one input before execution</p></td>
<td class="text-left"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;inputs&quot;</span></code></p></td>
<td class="text-left"><p>array</p></td>
<td class="text-left"><p>Defines the list of input/output mappings between this and dependency nodes, <strong>IMPORTANT</strong>: Please note that output shape, precision, and layout of previous node/request needs to match input of current node’s model</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;outputs&quot;</span></code></p></td>
<td class="text-left"><p>array</p></td>
<td class="text-left"><p>Defines model output name alias mapping - you can rename model output names for easier use in subsequent nodes</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="node-input-options">
<h3>Node Input Options<a class="headerlink" href="#node-input-options" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;node_name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Defines which node we refer to</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;data_item&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Defines which resource of the node we point to</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="node-output-options">
<h3>Node Output Options<a class="headerlink" href="#node-output-options" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;data_item&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Is the name of resource exposed by node - for <code class="docutils literal notranslate"><span class="pre">DL</span> <span class="pre">model</span></code> nodes it means model output</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;alias&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Is a name assigned to a data item, makes it easier to refer to results of this node in subsequent nodes</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="custom-node-options">
<h3>Custom Node Options<a class="headerlink" href="#custom-node-options" title="Permalink to this headline">¶</a></h3>
<p>In case the pipeline definition includes the custom node, the configuration file must include <code class="docutils literal notranslate"><span class="pre">custom_node_library_config_list</span></code>
section. It includes:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>The name of the custom node library - it will be used as a reference in the custom node pipeline definition</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;base_path&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Path the dynamic library with the custom node implementation</p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>Custom node definition in a pipeline configuration is similar to a model node. Node inputs and outputs are configurable in
the same way. Custom node functions are just like a standard node in that respect. The differences are in the extra parameters:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Option</p></th>
<th class="text-left head"><p>Type</p></th>
<th class="text-left head"><p>Description</p></th>
<th class="text-left head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;library_name&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Name of the custom node library defined in <code class="docutils literal notranslate"><span class="pre">custom_node_library_config_list</span></code></p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;type&quot;</span></code></p></td>
<td class="text-left"><p>string</p></td>
<td class="text-left"><p>Must be set to <code class="docutils literal notranslate"><span class="pre">custom</span></code></p></td>
<td class="text-left"><p>Yes</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&quot;params&quot;</span></code></p></td>
<td class="text-left"><p>json object with string values</p></td>
<td class="text-left"><p>a list of parameters and their values which could be used in the custom node implementation</p></td>
<td class="text-left"><p>No</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="using-pipelines-a-name-using-pipelines-a">
<h2>Using Pipelines <a name="using-pipelines"></a><a class="headerlink" href="#using-pipelines-a-name-using-pipelines-a" title="Permalink to this headline">¶</a></h2>
<p>Pipelines can use the same API as the models. There are exactly the same calls for running
the predictions. The request format must match the pipeline definition inputs.</p>
<p>The pipeline configuration can be queried using <a class="reference internal" href="model_server_grpc_api.html"><span class="doc std std-doc">gRPC GetModelMetadata</span></a> calls and
<a class="reference internal" href="model_server_rest_api.html"><span class="doc std std-doc">REST Metadata</span></a>.
It returns the definition of the pipelines inputs and outputs.</p>
<p>Similarly, pipelines can be queried for their state using the calls <a class="reference internal" href="model_server_grpc_api.html"><span class="doc std std-doc">GetModelStatus</span></a>
and <a class="reference internal" href="model_server_rest_api.html"><span class="doc std std-doc">REST Model Status</span></a></p>
<p>The only difference in using the pipelines and individual models is in version management. In all calls to the pipelines,
the version parameter is ignored. Pipelines are not versioned. Though, they can reference a particular version of the models in the graph.</p>
</section>
<section id="pipelines-examples-a-name-pipeline-examples-a">
<h2>Pipelines Examples <a name="pipeline-examples"></a><a class="headerlink" href="#pipelines-examples-a-name-pipeline-examples-a" title="Permalink to this headline">¶</a></h2>
<p><span class="xref myst">Single face analysis with combined models</span></p>
<p><span class="xref myst">Multiple vehicles analysis using demultiplexer with model_zoo_object_detection example custom node</span></p>
<p><span class="xref myst">Optical Character Recognition pipeline with east_ocr example custom node</span></p>
<p><span class="xref myst">Horizontal Text Detection pipeline with horizontal_ocr example custom node</span></p>
</section>
<section id="current-limitations-a-name-current-limitations-a">
<h2>Current limitations <a name="current-limitations"></a><a class="headerlink" href="#current-limitations-a-name-current-limitations-a" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Models with “auto” <a class="reference internal" href="dynamic_bs_auto_reload.html"><span class="doc std std-doc">batch size</span></a> or <a class="reference internal" href="dynamic_shape_auto_reload.html"><span class="doc std std-doc">shape</span></a> cannot be referenced in pipeline</p></li>
<li><p>Connected inputs and output for subsequent node models need to match each other in terms of data shape, precision and layout -
there is no automatic conversion between input/output model precisions or layouts. This limitation can be addressed with <code class="docutils literal notranslate"><span class="pre">--shape</span></code> and <code class="docutils literal notranslate"><span class="pre">--layout</span></code> model configuration or with a custom node to transform the data as required to match the expected data format.</p></li>
<li><p>REST requests with no named format (JSON body with one unnamed input) are not supported</p></li>
</ul>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="performance_tuning.html"><span class="doc std std-doc">Optimization of Performance</span></a></p></li>
</ul>
</section>
</section>


                </div>
            
            
                <div class='prev-next-bottom'>
                  

                </div>
            
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Intel®.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>